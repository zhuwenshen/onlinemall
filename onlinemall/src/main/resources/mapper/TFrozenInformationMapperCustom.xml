<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper
	namespace="com.zhuwenshen.mapper.TFrozenInformationMapperCustom">
	<resultMap id="BaseResultMap" type="com.zhuwenshen.model.TFrozenInformation">    
    <id column="id" jdbcType="CHAR" property="id" />
    <result column="frozen_user_id" jdbcType="CHAR" property="frozenUserId" />
    <result column="operating_user_id" jdbcType="CHAR" property="operatingUserId" />
    <result column="frozen_time" jdbcType="TIMESTAMP" property="frozenTime" />
    <result column="frozen_reason" jdbcType="VARCHAR" property="frozenReason" />
    <result column="unfreezing_time" jdbcType="TIMESTAMP" property="unfreezingTime" />
    <result column="remake" jdbcType="VARCHAR" property="remake" />
    <result column="deleted" jdbcType="BIT" property="deleted" />
    <result column="create_time" jdbcType="TIMESTAMP" property="createTime" />
    <result column="create_userid" jdbcType="CHAR" property="createUserid" />
    <result column="update_time" jdbcType="TIMESTAMP" property="updateTime" />
    <result column="update_userid" jdbcType="CHAR" property="updateUserid" />
  </resultMap>

	<select id="selectFrozenInforByUserId" resultMap="BaseResultMap">
		SELECT
			*
		FROM
			t_frozen_information
		WHERE
			id = (
				SELECT
					t.id
				FROM
					t_frozen_information t
				WHERE
					t.frozen_user_id = #{userId}
				AND t.unfreezing_time > #{date}
				AND t.deleted = 0
				GROUP BY
					t.id
				HAVING
					MAX(t.unfreezing_time)
			);
	</select>


</mapper>